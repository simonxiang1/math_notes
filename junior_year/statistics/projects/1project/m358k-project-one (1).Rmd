---
title: "Project #1: Part #2"
author: "Sam Queralt, Karim Aliyev, Connor Hixon, Simon Xiang"
date: "`r Sys.Date()`"
output: pdf_document
urlcolor: blue
---
<!-- The author of this template is Dr. Gordan Zitkovic.-->
<!-- The code chunk below contains some settings that will  -->
<!-- make your R code look better in the output pdf file.  -->
<!-- If you are curious about what each option below does, -->
<!-- go to https://yihui.org/knitr/options/ -->
<!-- If not, feel free to disregard everything ...  -->
```{r echo=FALSE, warning=FALSE, include=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  fig.align="center",
  fig.pos="t",
  strip.white = TRUE
)
```
<!-- ... down to here. -->

---

Before embarking on this project, go to [Wikipedia: the Monty Hall problem](https://en.wikipedia.org/wiki/Monty_Hall_problem). This Wikipedia entry contains the description of the original Monty Hall problem as well as its analysis and variations. 

---

## Problem #1. **(10 points)**
Read and understand the description of the original Monty Hall game. Now, write down your own description in your own words. Resist the temptation to copy-paste from an external resource since that will earn you zero points. It might help to imagine that you have a five-year old niece or nephew you are describing the game to. 

***Answer:*** The Monty Hall Problem describes a situation in which a contestant on a game show has the opportunity to win a prize by correctly choosing which door it lies behind. In the problem, there exists three doors, one of which conceals a prize. The contestant chooses a door, and the host reveals a door without a prize that is NOT the one that the contestant has chosen. Given the opportunity, should the contestant choose to switch their guess to the remaining door? 

## Problem #2. **(10 points)**
Write and execute code in `R` which will represent **one round** of the original Monty Hall game. More precisely, it should do the following:

- "choose" at random behind which door the prize will be,

- "choose" at random the door that the contestant picks,

- choose which door the host will open,

- determine whether it was optimal to **switch** or **stick** for this particular round and return this determination. 

```{r}
monty_hall <- function() {
  #the door that the prize is behind
  prize <- sample (1:3,1)

  #the contestant choice of door
  contestant <- sample(1:3,1)

  #door that is picked to open
  opened <- sample(c(1:3)[-c(prize,contestant)],1)

  if(prize == contestant){
     return ('Stick')
  } else {
     return ('Switch')
  }
}
print(monty_hall())
```


## Problem #3. **(10 points)**
Write and execute code in `R` which repeats 100 rounds of the Monty Hall game. For which proportion of these rounds was it optimal to **switch**? *Hint:* If you answer to the previous problem was not in the form of a function, make it so now. 
```{r}
result <- replicate(100, monty_hall())
mean(result == 'Switch')
print(mean)
```


## Problem #4 **(10 points)**
Write and execute code in `R` which repeats $n$ rounds of the Monty Hall game for $n=100, 110, 120, ..., 10000$. For each $n$, your code should record the proportion of individual rounds for which it was optimal to **switch**. In `R`, plot this recorded proportion as a function of $n$. 
Does your computational result agree with the analysis available at [Wikipedia: the Monty Hall problem](https://en.wikipedia.org/wiki/Monty_Hall_problem)? Why? It might also be useful to consult: [Wikipedia: The Law of Large Numbers](https://en.wikipedia.org/wiki/Law_of_large_numbers). 

```{r}
result2 <- c()
data_plot <- c()
for (i in seq(100, 10000, 10)){
  result2 = c(replicate(i, monty_hall()))
  data_plot = c(data_plot, mean(result2 == 'Switch'))
}

plot(data_plot, main = 'Monty Hall Simulation', ylab = 'Optimal to Switch proportion',
     xlab = 'Trial Number', col = 'blue')
```

Our data agrees with both the Monty Hall analysis and The Law of Large numbers. As the number of trials grows, the 'switch' proportion converges to $2/3$, as is expected in the Monty Hall problem. This supports The Law of Large Numbers because the result represents the expected result more and more closely as more trials are completed.
