---
title: "HW 3"
author: "SDS322E"
date: "`r format(Sys.Date(), '%B %d, %Y')`"
output:
  html_document:
    toc: true
    toc_float:
      collapsed: false
---

```{r global_options, include=FALSE}
#DO NOT EDIT THIS CHUNK OR ANYTHING ABOVE IT!
knitr::opts_chunk$set(echo = TRUE, eval = TRUE, fig.align = "center", warning = F, message = F, tidy=T, tidy.opts=list(width.cutoff=50))
```

```{r, include = FALSE}
colorize <- function(x, color = "cornflowerblue") {
  if (knitr::is_latex_output()) {
    sprintf("\\textcolor{%s}{%s}", color, x)
  } else if (knitr::is_html_output()) {
    sprintf("<span style='color: %s;'>%s</span>", color,
      x)
  } else x
}
```

## Simon Xiang, EID: `szx58`

**Please submit as a PDF or HTML file on Canvas before the due date.**

*For all questions, include the R commands/functions that you used to find your answer. Answers without supporting code will not receive credit.*

> #### Review of how to submit this assignment
>
> All homework assignments will be completed using R Markdown. These `.Rmd` files consist of \>text/syntax (formatted using Markdown) alongside embedded R code. When you have completed the assignment (by adding R code inside codeblocks and supporting text outside of the codeblocks), create your document as follows (assuming you are using the edupod server and submitting HTML):

> -   Click the arrow next to the "Knit" button (above)
> -   Choose "Knit to HTML"
> -   Go to Files pane and put checkmark next to the correct HTML file
> -   Click on the blue gear icon ("More") and click Export
> -   Download the file and then upload to Canvas

> To submit a PDF, open your HTML file and print it to a pdf, then upload the pdf as your submission.

------------------------------------------------------------------------

### Question 1: (2 pts)

The dataset `ChickWeight` contains information about the weights (in grams) of chicks on different diets over time (at 2-day intervals).

```{r}
ChickWeight <- as.data.frame(ChickWeight)
head(ChickWeight, 10)
```

**Answer the following questions:**

-   How many distinct chicks are there (e.g., each row with the same value of `Chick` correspond to the same chick)?

-   How many distinct time points?

-   How many distinct diet conditions?

-   How many chicks per diet condition at the start of the experiment (i.e., at Time 0)? For example, you could use some combination of `table()` and `length()` to answer these questions. *Do not forget to include the code you used to answer these questions!*

```{r}
length(table(ChickWeight$Chick))
length(table(ChickWeight$Time))
length(table(ChickWeight$Diet))
data.frame(table(ChickWeight$Diet))[2] %/% 12
```

There are 23 distinct chicks, 12 distinct time points, and 2 distinct diet conditions. At the start of the experiment (time = 0), we have diet condition

1. has 18 chicks
2. has 10 chicks
3. has 10 chicks
4. has 9 chicks

### Question 2.1: (2 pts)

##### Using the ggplot2 package, create a simple scatterplot showing chick `weight` (y-axis) as a function of `Time`. This time, relabel the axes more informatively and give the plot a title.

```{r}
library(tidyverse)
ggplot(ChickWeight, aes(x = Time, y = weight)) + geom_point() + xlab("Day of experiment") + ylab("Chick weight") + ggtitle("Scatterplot of chick weight as a function of the day of the experiment")
```

------------------------------------------------------------------------

### Question 2.2: (1 pts)

**Building upon the previous plot, do the following:**,

-   Map `Chick` to an aesthetic that assigns a color to each chick's data points.

-   Add lines that connect each chick's points together.

-   Finally, remove the legend. This can be done using `theme(legend.position = "none")`. Run `?theme` to see the options available for the themes.

```{r}
ggplot(ChickWeight, aes(x = Time, y = weight)) + geom_point(aes(col = Chick)) + xlab("Day of experiment") + ylab("Chick weight") + ggtitle("Scatterplot of chick weight as a function of the day of the experiment") + geom_line(aes(group = Chick, col = Chick)) + theme_classic()+  theme(legend.position = "none")
```

### Question 2.3: (1 pts)

**Take the plot you made in Question 2.2 and remove the color from the points only (leave the lines colored by chick, but make all of the points white). Put the points *on top of* the lines.**

```{r}
ggplot(ChickWeight, aes(x = Time, y = weight)) + xlab("Day of experiment") + ylab("Chick weight") + ggtitle("Scatterplot of chick weight as a function of the Day of experiment") + geom_line(aes(group = Chick, col = Chick)) + geom_point(col = "black", stroke = 0.5, shape = 21, fill = "white") +  theme_classic() +  theme(legend.position = "none")
```

### Question 2.4: (2 pts)

**Now, facet by diet. Is it clearer from this plot which diet is the best?** (No real right answer: Just show me you are thinking about it.)

```{r}
ggplot(ChickWeight, aes(x = Time, y = weight)) + xlab("Day of experiment") + ylab("Chick weight") + ggtitle("Scatterplot of chick weight as a function of the Day of experiment") + geom_line(aes(group = Chick, col = Chick)) + geom_point(col = "black", stroke = 0.5, shape = 21, fill = "white") +  theme_classic() +  theme(legend.position = "none") + facet_grid(~Diet)
```

It seems like diet three is the best because some of its chicks reach very large weights.

### Question 2.5: (1 pts)

Go back to your plot from question 2.1 and fit a *linear regression line* (not the default *loess*!) to the chicks in each diet with `geom_smooth(method = "lm").` There should be 4 separate straight lines, one for each diet, each a separate color. **Now can you see more clearly which diet results in greater weight? Does the effect of diet on weight appear to depend on time?**

```{r}
ggplot(ChickWeight, aes(x = Time, y = weight)) + geom_point(aes(col = Diet)) + xlab("Day of experiment") + ylab("Chick weight") + ggtitle("Scatterplot of chick weight as a function of the day of the experiment") + geom_smooth(method = "lm", aes(group = Diet, col = Diet)) + theme_bw()
```

**Answer:** This quantifies our intuition that diet 3 is the best diet for gaining weight. Diet and weight also seem to be positively correlated.

### Question 3: (2pts)

**Remake the figure from Question 2.5 with the following changes:**

-   Add the layer `facet_grid(~Diet)` to facet over `Diet`.
-   Replace the scatterplot with a series of boxplots (one for each unique time).
-   Change the theme (any `theme_` is fine as long as it is different from the default).
-   The points above the whiskers on the boxplot are "outliers." Remove the outliers from your figure. (There are a few different ways to do this; one way to do so is to set `outlier.shape = NA` in `geom_boxplot()`; `?geom_boxplot` might give you some guidance.)

*Hint:* to have a different boxplot for each unique `Time` you can set `group = Time` in the aesthetic mapping for `geom_boxplot`. *But you don't want this grouping to be for all of the `geom`'s, just for `geom_boxplot`!!!* You can do this by feeding `mapping = aes(group = Time)` into `geom_boxplot()`.

```{r}
ggplot(ChickWeight, aes(x = Time, y = weight)) + geom_boxplot(mapping = aes(group = Time, col = Diet), outlier.shape = NA) + xlab("Day of experiment") + ylab("Chick weight") + ggtitle("Scatterplot of chick weight as a function of the day of the experiment") + theme_bw() + facet_grid(~Diet) + geom_smooth(method = "lm", mapping = aes(group = Diet, col = Diet))
```

```{R, echo=F}
## DO NOT DELETE OR MODIFY THIS CHUNK: IT MUST BE PRESENT TO RECEIVE CREDIT FOR THE ASSIGNMENT
sessionInfo(); Sys.time(); Sys.info()
```
